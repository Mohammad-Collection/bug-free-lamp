{% comment %}
  Reveal Image 3D Section
  Shows an image that reveals a 5-second video with 3D effects on interaction
{% endcomment %}

{%- liquid
  assign image = section.settings.image
  assign video = section.settings.video
  assign title = section.settings.title
  assign description = section.settings.description
-%}

<div class="reveal-3d-section">
  {% if title != blank %}
    <h2 class="reveal-3d-title">{{ title }}</h2>
  {% endif %}
  
  {% if description != blank %}
    <p class="reveal-3d-description">{{ description }}</p>
  {% endif %}
  
  <div class="reveal-image-container" 
       data-image="{{ image | image_url: width: 800 }}" 
       data-video="{{ video | file_url }}">
    
    <div class="reveal-image-wrapper">
      {% if image %}
        <img class="reveal-image" 
             src="{{ image | image_url: width: 800 }}" 
             alt="{{ image.alt | escape }}"
             loading="lazy">
      {% else %}
        <div class="reveal-image placeholder-image">
          <p>Add an image in the section settings</p>
        </div>
      {% endif %}
      
      {% if video %}
        <video class="reveal-video" 
               preload="metadata" 
               muted 
               playsinline>
          <source src="{{ video | file_url }}" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      {% else %}
        <div class="reveal-video placeholder-video">
          <p>Add a video in the section settings</p>
        </div>
      {% endif %}
    </div>
    
    {% comment %} Interaction hint {% endcomment %}
    <div class="interaction-hint">
      <span>Click or hover to reveal</span>
    </div>
  </div>
</div>

<style>
  .reveal-3d-section {
    padding: 40px 20px;
    text-align: center;
    max-width: 1200px;
    margin: 0 auto;
  }
  
  .reveal-3d-title {
    font-size: 2.5em;
    margin-bottom: 20px;
    color: #333;
    font-weight: bold;
  }
  
  .reveal-3d-description {
    font-size: 1.2em;
    color: #666;
    margin-bottom: 40px;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }
  
  .placeholder-image,
  .placeholder-video {
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f0f0f0;
    color: #999;
    font-style: italic;
    border: 2px dashed #ccc;
  }
  
  .interaction-hint {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 0.9em;
    opacity: 0.8;
    transition: opacity 0.3s ease;
    pointer-events: none;
  }
  
  .reveal-image-container:hover .interaction-hint {
    opacity: 0;
  }
  
  @media (max-width: 768px) {
    .reveal-3d-title {
      font-size: 2em;
    }
    
    .reveal-3d-description {
      font-size: 1em;
    }
  }
</style>

{% schema %}
{
  "name": "Reveal Image 3D",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "default": "Interactive 3D Reveal"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Hover or click the image to reveal a 5-second video with amazing 3D effects!"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Cover Image",
      "info": "This image will be shown initially"
    },
    {
      "type": "file",
      "id": "video",
      "label": "Reveal Video",
      "accept": "video/*",
      "info": "Video that plays for 5 seconds when image is clicked/hovered (MP4 recommended)"
    }
  ],
  "presets": [
    {
      "name": "Reveal Image 3D"
    }
  ]
}
{% endschema %}